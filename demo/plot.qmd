# Plotting

This chapter is utterly incomplete and probably not worth reading.

```{julia}
#| echo: false
#| warning: false
include("setup.jl")
import MMJMesh.Plots: approximationerror, sampleadaptive
```

## Plot a 1D mesh

### On a straight line

```{julia}
m = makemeshoninterval(0, 4, 20)
mplot(m) |> mconf()
```

Nodes hidden if too many.

```{julia}
m = makemeshoninterval(0, 4, 60)
mplot(m) |> mconf()
```

One value per node

```{julia}
mplot(m, -1.1 .+ 2.6 * rand(nnodes(m))) |> mconf()
```

One value per element

```{julia}
mplot(m, -1.1 .+ 2.2 * rand(nedges(m))) |> mconf()
```

Two values per element

```{julia}
mplot(m, -1.1 .+ 2.2 * rand(2, nedges(m))) |> mconf()
```

### Vertical

```{julia}
m = makemeshoninterval(π, 3π, 20, t -> [0; t])
mplot(m, -1.1 .+ 3.2 * rand(nedges(m))) |> mconf()
```

### On a spiral

```{julia}
m = makemeshoninterval(π, 3π, 20, t -> t * [cos(t); sin(t)])
mplot(m, -1.1 .+ 3.2 * rand(2, nedges(m))) |> mconf()
```

### Customize plot

Plot customization works like this:

```{julia}
f, ax = mplot(m, -1.1 .+ 3.2 * rand(2, nedges(m))) |> mconf()
ax.title = "Spiral with reversed vertical axis"
ax.yreversed = true
f
```

Documentation on plot axis can be found on the [Makie documentation](https://docs.makie.org/stable/reference/blocks/axis) which unfortunately is quite hard to read.

## Plot a 2D mesh

### Quad mesh

```{julia}
a = 80
m = makemeshonrectangle(9.0, 4.5, 2a, a)
println("Number of nodes is Nn = ", (a + 1) * (2a + 1))
print("Links...")
@time l12 = links(m.topology, 1, 2);
```

Default color

```{julia}
mplot(m, edgesvisible=true, edgecolor=:hotpink) |> mconf()
```

Colors for nodes

```{julia}
mplot(m, 4.1 * (rand(nnodes(m)) .- 0.25)) |> mconf()
```

Colors for elements

```{julia}
mplot(m, 4.1 * (rand(nfaces(m)) .- 0.25)) |> mconf()
```

### Triangle mesh

```{julia}
a = 20
m = makemeshonrectangle(9.0, 4.5, 2a, a, TRIANGLE)
println("Nn = ", (a + 1) * (2a + 1))
print("Links (1, 2):")
@time l12 = links(m.topology, 1, 2);
```

Default color

```{julia}
mplot(m, edgesvisible=true) |> mconf()
```

Colors for nodes

```{julia}
mplot(m, 4.1 * (rand(nnodes(m)) .- 0.25)) |> mconf()
```

Colors for elements

```{julia}
mplot(m, 4.1 * (rand(nfaces(m)) .- 0.25)) |> mconf()
```


## Plot options

```{julia}
a = 10
m1 = makemeshonrectangle(4, 2, 2a, a)
mplot(m1, 3 * rand(nfaces(m1)),
    nodesvisible=true, nodecolor=:hotpink, nodesize=12,
    edgesvisible=true, edgecolor=:lightblue, edgelinewidth=3,
    featureedgecolor=:red, featureedgelinewidth=6,
    facecolormap=:bluesreds
) |> mconf()
```

```{julia}
m2 = makemeshoninterval(0, 4, 20)
mplot(m2, rand(nnodes(m2)),
    lineplotoutlinesvisible=true,
    edgecolor=:blue, edgelinewidth=10,
    lineplotscale=0.3,
    lineplotoutlinescolor=:hotpink,
    lineplotoutlineslinewidth=2.0,
    lineplotfacescolormap=:bluesreds
) |> mconf(title="Test Plot")
```

